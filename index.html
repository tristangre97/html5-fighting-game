<!doctype html>
<!--
Copyright 2010 Google Inc.
Copyright 2025 - HTML5 Fighting Game Multiplayer

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>HTML5 Fighting Game - Multiplayer</title>

<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>
<link rel='stylesheet' type='text/css' href='style.css' />

<script src='http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.js'></script>
<script src='/socket.io/socket.io.js'></script>

<script src='window.js'></script>
<script src='level.js'></script>
<script src='sprite.js'></script>
<script src='player.js'></script>
<script src='network.js'></script>
<script src='gamepad.js'></script>
<script src='touchcontrols.js'></script>
<script src='gamejam.js'></script>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Inter:wght@400;500;600;700&display=swap');

  body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    font-family: 'Inter', sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }

  .pixel-font {
    font-family: 'Press Start 2P', cursive;
  }

  /* Canvas and game images */
  #canvas {
    display: block;
    margin: 0 auto;
  }

  #game_over, #fight {
    display: none;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 100;
  }

  /* Mobile Touch Controls */
  #touch-controls {
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    pointer-events: none;
    z-index: 500;
    display: none;
  }

  #joystick-area {
    position: absolute;
    left: 30px;
    bottom: 80px;
    width: 150px;
    height: 150px;
    pointer-events: all;
  }

  #joystick-base {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 120px;
    height: 120px;
    background: rgba(255, 255, 255, 0.15);
    border: 4px solid rgba(255, 255, 255, 0.4);
    border-radius: 50%;
    backdrop-filter: blur(10px);
  }

  #joystick-stick {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 50px;
    height: 50px;
    background: rgba(255, 255, 255, 0.7);
    border: 4px solid rgba(255, 255, 255, 0.9);
    border-radius: 50%;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    transition: transform 0.05s;
  }

  .touch-button {
    position: absolute;
    width: 70px;
    height: 70px;
    background: rgba(255, 255, 255, 0.2);
    border: 4px solid rgba(255, 255, 255, 0.5);
    border-radius: 50%;
    pointer-events: all;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;
    font-weight: 700;
    color: white;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(10px);
    transition: all 0.1s;
    user-select: none;
    -webkit-user-select: none;
  }

  .touch-button.active {
    background: rgba(255, 255, 255, 0.5);
    transform: scale(0.92);
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
  }

  #btn-jump {
    right: 30px;
    bottom: 180px;
    background: rgba(34, 197, 94, 0.3);
    border-color: rgba(34, 197, 94, 0.7);
  }

  #btn-jump.active {
    background: rgba(34, 197, 94, 0.6);
  }

  #btn-punch {
    right: 130px;
    bottom: 100px;
    background: rgba(239, 68, 68, 0.3);
    border-color: rgba(239, 68, 68, 0.7);
  }

  #btn-punch.active {
    background: rgba(239, 68, 68, 0.6);
  }

  #btn-throw {
    right: 30px;
    bottom: 80px;
    background: rgba(249, 115, 22, 0.3);
    border-color: rgba(249, 115, 22, 0.7);
  }

  #btn-throw.active {
    background: rgba(249, 115, 22, 0.6);
  }

  #btn-block {
    right: 130px;
    bottom: 180px;
    background: rgba(59, 130, 246, 0.3);
    border-color: rgba(59, 130, 246, 0.7);
  }

  #btn-block.active {
    background: rgba(59, 130, 246, 0.6);
  }

  /* Animations */
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes slideUp {
    from { transform: translateY(20px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }

  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }

  .animate-fadeIn {
    animation: fadeIn 0.3s ease-out;
  }

  .animate-slideUp {
    animation: slideUp 0.4s ease-out;
  }

  /* Landscape mobile */
  @media (max-width: 896px) and (orientation: landscape) {
    #joystick-area {
      left: 20px;
      bottom: 30px;
      width: 120px;
      height: 120px;
    }

    #joystick-base {
      width: 100px;
      height: 100px;
    }

    #joystick-stick {
      width: 40px;
      height: 40px;
    }

    .touch-button {
      width: 60px;
      height: 60px;
      font-size: 9px;
    }

    #btn-jump {
      right: 20px;
      bottom: 120px;
    }

    #btn-punch {
      right: 100px;
      bottom: 60px;
    }

    #btn-throw {
      right: 20px;
      bottom: 50px;
    }

    #btn-block {
      right: 100px;
      bottom: 120px;
    }
  }
</style>
</head>

<body class="min-h-screen flex items-center justify-center">

  <!-- Main Menu -->
  <div id="menu" class="fixed inset-0 flex items-center justify-center z-[1000] bg-gradient-to-br from-purple-900/50 to-indigo-900/50 backdrop-blur-sm animate-fadeIn">
    <div class="bg-white/10 backdrop-blur-md rounded-3xl shadow-2xl p-8 md:p-12 max-w-2xl w-full mx-4 border border-white/20 animate-slideUp">

      <!-- Title -->
      <div class="text-center mb-8">
        <h1 class="pixel-font text-3xl md:text-5xl text-white mb-3 drop-shadow-lg">
          FIGHT<span class="text-yellow-400">!</span>GAME
        </h1>
        <p class="text-white/80 text-sm md:text-base">Ultimate Multiplayer Fighting Experience</p>
      </div>

      <!-- Mode Selection -->
      <div class="space-y-4 mb-8">
        <button id="local-btn" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-4 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 hover:shadow-xl flex items-center justify-between group">
          <span class="flex items-center">
            <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
            </svg>
            Local 2-Player
          </span>
          <svg class="w-5 h-5 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
          </svg>
        </button>

        <button id="online-btn" class="w-full bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-bold py-4 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 hover:shadow-xl flex items-center justify-between group">
          <span class="flex items-center">
            <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/>
            </svg>
            Online Multiplayer
          </span>
          <svg class="w-5 h-5 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
          </svg>
        </button>
      </div>

      <!-- Controls Info -->
      <div class="bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10">
        <h3 class="text-white font-bold mb-4 flex items-center">
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          Controls
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-white/90">
          <div>
            <div class="font-semibold mb-2 text-green-400">üéÆ Keyboard</div>
            <div class="space-y-1 text-xs">
              <div><kbd class="px-2 py-1 bg-white/10 rounded">A/D</kbd> Move</div>
              <div><kbd class="px-2 py-1 bg-white/10 rounded">W</kbd> Jump</div>
              <div><kbd class="px-2 py-1 bg-white/10 rounded">R</kbd> Punch</div>
              <div><kbd class="px-2 py-1 bg-white/10 rounded">T</kbd> Throw</div>
            </div>
          </div>
          <div>
            <div class="font-semibold mb-2 text-blue-400">üéÆ Controller</div>
            <div class="space-y-1 text-xs">
              <div><kbd class="px-2 py-1 bg-white/10 rounded">A/X</kbd> Jump</div>
              <div><kbd class="px-2 py-1 bg-white/10 rounded">B/‚óã</kbd> Punch</div>
              <div><kbd class="px-2 py-1 bg-white/10 rounded">X/‚ñ°</kbd> Throw</div>
              <div><kbd class="px-2 py-1 bg-white/10 rounded">Y/‚ñ≥</kbd> Block</div>
            </div>
          </div>
        </div>
        <div class="mt-4 text-xs text-white/60 text-center">
          üí° Move away from opponent to block attacks
        </div>
      </div>

      <!-- FPS Settings -->
      <div class="mt-6 bg-white/5 backdrop-blur-sm rounded-xl p-4 border border-white/10">
        <div class="flex items-center justify-between">
          <span class="text-white/80 text-sm">Frame Rate:</span>
          <select id="fps-select" class="bg-white/10 text-white border border-white/20 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
            <option value="60">60 FPS (Recommended)</option>
            <option value="120">120 FPS (High Performance)</option>
            <option value="144">144 FPS (Ultra)</option>
          </select>
        </div>
      </div>

      <!-- Footer -->
      <div class="mt-6 text-center text-white/50 text-xs">
        Press ESC to pause ‚Ä¢ Made with ‚ù§Ô∏è for fighters
      </div>
    </div>
  </div>

  <!-- Status Messages -->
  <div id="status" class="hidden fixed top-6 left-1/2 transform -translate-x-1/2 z-[999] animate-slideUp">
    <div class="bg-white/10 backdrop-blur-md text-white px-6 py-3 rounded-full shadow-2xl border border-white/20 font-semibold">
      <div class="flex items-center space-x-2">
        <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
        <span id="status-text">Connecting...</span>
      </div>
    </div>
  </div>

  <!-- Game HUD Overlay -->
  <div id="game-hud" class="hidden fixed top-0 left-0 right-0 z-[800] p-4">
    <div class="max-w-7xl mx-auto">
      <!-- Player Health Bars -->
      <div class="flex items-center justify-between gap-4">
        <!-- Player 1 -->
        <div class="flex-1 bg-white/10 backdrop-blur-md rounded-xl p-3 border border-white/20">
          <div class="flex items-center justify-between mb-2">
            <span class="text-white font-bold text-sm">PLAYER 1</span>
            <span id="p1-health-text" class="text-white font-bold text-sm">100</span>
          </div>
          <div class="w-full bg-black/30 rounded-full h-3 overflow-hidden">
            <div id="p1-health-bar" class="bg-gradient-to-r from-green-500 to-emerald-400 h-full rounded-full transition-all duration-300" style="width: 100%"></div>
          </div>
        </div>

        <!-- Timer/Round Info -->
        <div class="bg-white/10 backdrop-blur-md rounded-xl px-6 py-3 border border-white/20">
          <div class="text-white text-center">
            <div class="pixel-font text-2xl">VS</div>
          </div>
        </div>

        <!-- Player 2 -->
        <div class="flex-1 bg-white/10 backdrop-blur-md rounded-xl p-3 border border-white/20">
          <div class="flex items-center justify-between mb-2">
            <span id="p2-health-text" class="text-white font-bold text-sm">100</span>
            <span class="text-white font-bold text-sm">PLAYER 2</span>
          </div>
          <div class="w-full bg-black/30 rounded-full h-3 overflow-hidden">
            <div id="p2-health-bar" class="bg-gradient-to-r from-red-500 to-orange-400 h-full rounded-full transition-all duration-300" style="width: 100%"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Game Canvas Container -->
  <div id="game-container" class="w-full h-screen flex items-center justify-center">
    <canvas width="0" height="0" id="canvas" class="shadow-2xl rounded-lg">
      Your browser doesn't support the canvas element. Please use a modern browser.
    </canvas>
    <img id="game_over" src="game_over.png" alt="Game Over">
    <img id="fight" src="fight.png" alt="Fight!">
  </div>

  <!-- Controls Hint (Desktop) -->
  <div id="controls-hint" class="hidden fixed bottom-4 left-1/2 transform -translate-x-1/2 z-[700]">
    <div class="bg-black/50 backdrop-blur-md text-white px-4 py-2 rounded-full text-xs border border-white/20">
      Press <kbd class="px-2 py-1 bg-white/20 rounded mx-1">P</kbd> for debug ‚Ä¢ <kbd class="px-2 py-1 bg-white/20 rounded mx-1">O</kbd> toggle scroll
    </div>
  </div>

  <!-- Debug Info -->
  <div id="debug" class="hidden fixed top-20 right-4 z-[700] bg-black/80 backdrop-blur-md text-green-400 px-4 py-2 rounded-lg font-mono text-xs border border-green-500/50"></div>

  <!-- Touch Controls for Mobile -->
  <div id="touch-controls">
    <div id="joystick-area">
      <div id="joystick-base"></div>
      <div id="joystick-stick"></div>
    </div>
    <div id="btn-jump" class="touch-button">JUMP</div>
    <div id="btn-punch" class="touch-button">PUNCH</div>
    <div id="btn-throw" class="touch-button">THROW</div>
    <div id="btn-block" class="touch-button">BLOCK</div>
  </div>

</body>
</html>

